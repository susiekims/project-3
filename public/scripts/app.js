(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
'use strict';

var wineApp = {};
wineApp.productID;

var searchFood = void 0;
var searchPrice = void 0;

wineApp.getWines = function (food, price, pageNumber) {
	$('#map').toggle(false);
	var randomPageNumber = Math.floor(Math.random() * 100);
	$.ajax({
		url: 'https://lcboapi.com/products',
		method: 'GET',
		dataType: 'json',
		headers: {
			'Authorization': 'Token MDoxZmYyNzU4MC03NWE3LTExZTgtYmVmMy0zYmY0Njk4ZDI5YTA6cHhBRGw5RWFmMjZuQk1PcWJhZzg1Vm5OMzBLaWpkTnNqU0ZW'
		},
		data: {
			per_page: 100,
			page: pageNumber,
			q: 'wine'
		}
	}).then(function (res) {
		var products = res.result;
		searchFood = $('#food').val();
		searchPrice = $('#price').val();

		var filteredWineList = products.filter(function (product) {
			return product.serving_suggestion != null && product.image_url != null && product.primary_category === 'Wine' && product.price_in_cents >= price - 400 && product.serving_suggestion.indexOf(food) != -1 && product.package_unit_volume_in_milliliters === 750;
		});
		console.log(pageNumber);
		console.log(filteredWineList);

		if (filteredWineList.length > 0) {
			var randomWine = filteredWineList[Math.floor(Math.random() * filteredWineList.length)];
			console.log(randomWine);
			wineApp.displayWine(randomWine);
		} else {
			wineApp.getWines(searchFood, searchPrice, randomPageNumber);
		}
	});
};

wineApp.displayWine = function (wine) {
	$('#loader').removeClass("loader");
	$('#locations').toggle(true);
	var $name = $('<h2>').text(wine.name);
	var $producer = $('<h3>').text(wine.producer_name);
	var $varietal = $('<p>').text(wine.varietal);
	var $serving = $('<p>').text(wine.serving_suggestion);
	var $taste = $('<p>').text(wine.tasting_note);
	var $imgURL = $('<img>').attr('src', wine.image_url);
	$('#wine').append($name, $producer, $varietal, $taste, $serving, $imgURL);
	wineApp.productID = wine.id;
};

wineApp.getUserCoords = function () {
	navigator.geolocation.getCurrentPosition(function (position) {
		var userLat = position.coords.latitude;
		var userLng = position.coords.longitude;
		wineApp.getStores(wineApp.productID, userLat, userLng);
	});
};

wineApp.msmTo24time = function (msm) {
	var hour = msm / 60;
	var mins = msm % 60;
	if (mins === 0) {
		var twoZeroes = '00';
		return [Math.floor(hour), twoZeroes];
	} else {
		return [Math.floor(hour), mins];
	}
};
wineApp.msmTo12time = function (msm) {
	var time = wineApp.msmTo24time(msm);
	var h24 = time[0];
	var h12 = 0 == h24 ? 12 : h24 > 12 ? h24 - 10 - 2 : h24;
	var ampm = h24 >= 12 ? 'PM' : 'AM';
	return [h12, time[1], ampm];
};
wineApp.getTime = function (msm) {
	var time = wineApp.msmTo12time(msm);
	var newTime = time[0] + ':' + time[1] + time[2];
	return newTime;
};

wineApp.getStores = function (idNumber, latitude, longitude) {
	$.ajax({
		url: 'https://lcboapi.com/stores',
		method: 'GET',
		dataType: 'json',
		headers: {
			'Authorization': 'Token MDoxZmYyNzU4MC03NWE3LTExZTgtYmVmMy0zYmY0Njk4ZDI5YTA6cHhBRGw5RWFmMjZuQk1PcWJhZzg1Vm5OMzBLaWpkTnNqU0ZW'
		},
		data: {
			product_id: idNumber,
			per_page: 10,
			lat: latitude,
			lon: longitude
		}
	}).then(function (res) {
		var stores = res.result;
		console.log(stores);
		if (stores.length == 0) {
			$('#map').append('<h1>Sorry, no stores near you carry this wine</h1>');
		} else {

			var userCoords = {
				lat: latitude,
				lng: longitude
			};
			var storeInfo = [];
			for (var i = 0; i < stores.length; i++) {
				storeInfo[i] = {
					coords: {
						lat: stores[i].latitude,
						lng: stores[i].longitude
					},
					storeName: stores[i].name,
					hours: {
						monday: {
							open: wineApp.getTime(stores[i].monday_open),
							close: wineApp.getTime(stores[i].monday_close)
						},
						tuesday: {
							open: wineApp.getTime(stores[i].tuesday_open),
							close: wineApp.getTime(stores[i].tuesday_close)
						},
						wednesday: {
							open: wineApp.getTime(stores[i].wednesday_open),
							close: wineApp.getTime(stores[i].wednesday_close)
						},
						thursday: {
							open: wineApp.getTime(stores[i].thursday_open),
							close: wineApp.getTime(stores[i].thursday_close)
						},
						friday: {
							open: wineApp.getTime(stores[i].friday_open),
							close: wineApp.getTime(stores[i].friday_close)
						},
						saturday: {
							open: wineApp.getTime(stores[i].saturday_open),
							close: wineApp.getTime(stores[i].saturday_close)
						},
						sunday: {
							open: wineApp.getTime(stores[i].sunday_open),
							close: wineApp.getTime(stores[i].sunday_close)
						}
					},
					quantity: stores[i].quantity,
					distance: stores[i].distance_in_meters / 1000,
					address: stores[i].address_line_1
				};
			}

			wineApp.loadMap(userCoords, storeInfo);
		}
	});
};

wineApp.loadMap = function (centerCoords, storesWithProduct) {
	$('#map').toggle(true);
	$('#list').toggle(true);
	var map = new google.maps.Map(document.getElementById('map'), { zoom: 12, center: centerCoords });
	var markers = [];
	var infoWindow = [];
	var contentHTML = [];
	var locationsHTML = [];

	var _loop = function _loop(i) {
		contentHTML[i] = '<div id="content_' + i + '">\n\t\t\t<h3>' + storesWithProduct[i].storeName + '</h3>\n\t\t\t<h3>Hours</h3>\n\t\t\t<ul>\n\t\t\t\t<li>Monday: ' + storesWithProduct[i].hours.monday.open + ' - ' + storesWithProduct[i].hours.monday.close + '</li>\n\t\t\t\t<li>Tuesday: ' + storesWithProduct[i].hours.tuesday.open + ' - ' + storesWithProduct[i].hours.tuesday.close + '</li>\n\t\t\t\t<li>Wednesday: ' + storesWithProduct[i].hours.wednesday.open + ' - ' + storesWithProduct[i].hours.wednesday.close + '</li>\n\t\t\t\t<li>Thursday: ' + storesWithProduct[i].hours.thursday.open + ' - ' + storesWithProduct[i].hours.thursday.close + '</li>\n\t\t\t\t<li>Friday: ' + storesWithProduct[i].hours.friday.open + ' - ' + storesWithProduct[i].hours.friday.close + '</li>\n\t\t\t\t<li>Saturday: ' + storesWithProduct[i].hours.saturday.open + ' - ' + storesWithProduct[i].hours.saturday.close + '</li>\n\t\t\t\t<li>Sunday: ' + storesWithProduct[i].hours.sunday.open + ' - ' + storesWithProduct[i].hours.sunday.close + '</li>\n\t\t\t</ul>\n\t\t\t<h3>Bottles in stock: ' + storesWithProduct[i].quantity + '</h3>\n\t\t';
		var userMarker = new google.maps.Marker({
			position: centerCoords,
			map: map
		});
		markers[i] = new google.maps.Marker({
			position: storesWithProduct[i].coords,
			label: '' + (i + 1),
			map: map
		});
		infoWindow[i] = new google.maps.InfoWindow({
			content: contentHTML[i]
		});
		markers[i].addListener('click', function () {
			infoWindow[i].open(map, markers[i]);
		});
		locationsHTML[i] = '\n\t\t<li>\n\t\t\t<h3>' + storesWithProduct[i].storeName + '</h3>\n\t\t\t<p>' + storesWithProduct[i].address + '</p>\n\t\t\t<p>' + storesWithProduct[i].distance + 'km away</p>\n\t\t\t<p>' + storesWithProduct[i].quantity + ' bottles in stock</p>\n\t\t</li>\n        ';
		$('#list').append(locationsHTML[i]);
	};

	for (var i = 0; i < storesWithProduct.length; i++) {
		_loop(i);
	}
};

wineApp.init = function () {
	$('#wineButton').on('click', function (e) {
		e.preventDefault();
		$('#loader').addClass("loader");
		$('#locations').toggle(false);
		$('#wine').empty();
		searchFood = $('#food').val();
		searchPrice = $('#price').val();
		console.log(searchFood + searchPrice);
		wineApp.getWines(searchFood, searchPrice, Math.floor(Math.random() * 100));
	});
	$('#storeButton').on('click', function (e) {
		wineApp.getUserCoords();
	});
};

$(function () {
	wineApp.init();
});

// 1. how to loop through function on how many pages exist
// 2. how to run flattenArray after getAllWines (promises?)

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJkZXYvc2NyaXB0cy9hcHAuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7OztBQ0FBLElBQU0sVUFBVSxFQUFoQjtBQUNBLFFBQVEsU0FBUjs7QUFFQSxJQUFJLG1CQUFKO0FBQ0EsSUFBSSxvQkFBSjs7QUFFQSxRQUFRLFFBQVIsR0FBbUIsVUFBQyxJQUFELEVBQU8sS0FBUCxFQUFjLFVBQWQsRUFBNkI7QUFDaEQsR0FBRSxNQUFGLEVBQVUsTUFBVixDQUFpQixLQUFqQjtBQUNBLEtBQU0sbUJBQW1CLEtBQUssS0FBTCxDQUFXLEtBQUssTUFBTCxLQUFjLEdBQXpCLENBQXpCO0FBQ0MsR0FBRSxJQUFGLENBQU87QUFDTixPQUFLLDhCQURDO0FBRU4sVUFBUSxLQUZGO0FBR04sWUFBUyxNQUhIO0FBSU4sV0FBUztBQUNSLG9CQUFpQjtBQURULEdBSkg7QUFPTixRQUFNO0FBQ0wsYUFBVSxHQURMO0FBRUwsU0FBTSxVQUZEO0FBR0wsTUFBRztBQUhFO0FBUEEsRUFBUCxFQVlJLElBWkosQ0FZUyxVQUFTLEdBQVQsRUFBYztBQUNyQixNQUFNLFdBQVcsSUFBSSxNQUFyQjtBQUNBLGVBQWEsRUFBRSxPQUFGLEVBQVcsR0FBWCxFQUFiO0FBQ0EsZ0JBQWMsRUFBRSxRQUFGLEVBQVksR0FBWixFQUFkOztBQUVBLE1BQU0sbUJBQW1CLFNBQVMsTUFBVCxDQUFnQixVQUFDLE9BQUQsRUFBYTtBQUNyRCxVQUFPLFFBQVEsa0JBQVIsSUFBOEIsSUFBOUIsSUFDSCxRQUFRLFNBQVIsSUFBcUIsSUFEbEIsSUFFQSxRQUFRLGdCQUFSLEtBQTZCLE1BRjdCLElBR0EsUUFBUSxjQUFSLElBQTBCLFFBQVEsR0FIbEMsSUFJQSxRQUFRLGtCQUFSLENBQTJCLE9BQTNCLENBQW1DLElBQW5DLEtBQTRDLENBQUMsQ0FKN0MsSUFLQSxRQUFRLGtDQUFSLEtBQStDLEdBTHREO0FBTUEsR0FQd0IsQ0FB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QXFCLFFBSnJCLDhCQUtBLGtCQUFrQixDQUFsQixFQUFxQixRQUxyQjtBQVFBLElBQUUsT0FBRixFQUFXLE1BQVgsQ0FBa0IsY0FBYyxDQUFkLENBQWxCO0FBckQrQzs7QUFXdEQsTUFBSyxJQUFJLElBQUksQ0FBYixFQUFnQixJQUFJLGtCQUFrQixNQUF0QyxFQUE4QyxHQUE5QyxFQUFtRDtBQUFBLFFBQTFDLENBQTBDO0FBMkNsRDtBQUNELENBdkREOztBQXlEQSxRQUFRLElBQVIsR0FBZSxZQUFNO0FBQ3BCLEdBQUUsYUFBRixFQUFpQixFQUFqQixDQUFvQixPQUFwQixFQUE2QixVQUFTLENBQVQsRUFBWTtBQUN4QyxJQUFFLGNBQUY7QUFDQSxJQUFFLFNBQUYsRUFBYSxRQUFiLENBQXNCLFFBQXRCO0FBQ0EsSUFBRSxZQUFGLEVBQWdCLE1BQWhCLENBQXVCLEtBQXZCO0FBQ0EsSUFBRSxPQUFGLEVBQVcsS0FBWDtBQUNBLGVBQWEsRUFBRSxPQUFGLEVBQVcsR0FBWCxFQUFiO0FBQ0EsZ0JBQWMsRUFBRSxRQUFGLEVBQVksR0FBWixFQUFkO0FBQ0EsVUFBUSxHQUFSLENBQVksYUFBYSxXQUF6QjtBQUNBLFVBQVEsUUFBUixDQUFpQixVQUFqQixFQUE2QixXQUE3QixFQUEwQyxLQUFLLEtBQUwsQ0FBVyxLQUFLLE1BQUwsS0FBYyxHQUF6QixDQUExQztBQUNBLEVBVEQ7QUFVQSxHQUFFLGNBQUYsRUFBa0IsRUFBbEIsQ0FBcUIsT0FBckIsRUFBOEIsVUFBUyxDQUFULEVBQVk7QUFDekMsVUFBUSxhQUFSO0FBQ0EsRUFGRDtBQUdBLENBZEQ7O0FBZ0JBLEVBQUUsWUFBVztBQUNaLFNBQVEsSUFBUjtBQUNBLENBRkQ7O0FBS0E7QUFDQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighZiYmYylyZXR1cm4gYyhpLCEwKTtpZih1KXJldHVybiB1KGksITApO3ZhciBhPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIraStcIidcIik7dGhyb3cgYS5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGF9dmFyIHA9bltpXT17ZXhwb3J0czp7fX07ZVtpXVswXS5jYWxsKHAuZXhwb3J0cyxmdW5jdGlvbihyKXt2YXIgbj1lW2ldWzFdW3JdO3JldHVybiBvKG58fHIpfSxwLHAuZXhwb3J0cyxyLGUsbix0KX1yZXR1cm4gbltpXS5leHBvcnRzfWZvcih2YXIgdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGk9MDtpPHQubGVuZ3RoO2krKylvKHRbaV0pO3JldHVybiBvfXJldHVybiByfSkoKSIsImNvbnN0IHdpbmVBcHAgPSB7fVxud2luZUFwcC5wcm9kdWN0SUQ7XG5cbmxldCBzZWFyY2hGb29kIDtcbmxldCBzZWFyY2hQcmljZSA7XG5cbndpbmVBcHAuZ2V0V2luZXMgPSAoZm9vZCwgcHJpY2UsIHBhZ2VOdW1iZXIpID0+IHtcbiQoJyNtYXAnKS50b2dnbGUoZmFsc2UpO1x0XG5jb25zdCByYW5kb21QYWdlTnVtYmVyID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKjEwMCk7XHRcblx0JC5hamF4KHtcblx0XHR1cmw6ICdodHRwczovL2xjYm9hcGkuY29tL3Byb2R1Y3RzJyxcblx0XHRtZXRob2Q6ICdHRVQnLFxuXHRcdGRhdGFUeXBlOidqc29uJyxcblx0XHRoZWFkZXJzOiB7XG5cdFx0XHQnQXV0aG9yaXphdGlvbic6ICdUb2tlbiBNRG94Wm1ZeU56VTRNQzAzTldFM0xURXhaVGd0WW1WbU15MHpZbVkwTmprNFpESTVZVEE2Y0hoQlJHdzVSV0ZtTWpadVFrMVBjV0poWnpnMVZtNU9NekJMYVdwa1RuTnFVMFpXJ1xuXHRcdFx0fSxcblx0XHRkYXRhOiB7XG5cdFx0XHRwZXJfcGFnZTogMTAwLFxuXHRcdFx0cGFnZTogcGFnZU51bWJlcixcblx0XHRcdHE6ICd3aW5lJyxcblx0XHR9XG5cdFx0fSkudGhlbihmdW5jdGlvbihyZXMpIHtcblx0XHRcdGNvbnN0IHByb2R1Y3RzID0gcmVzLnJlc3VsdDtcblx0XHRcdHNlYXJjaEZvb2QgPSAkKCcjZm9vZCcpLnZhbCgpO1xuXHRcdFx0c2VhcmNoUHJpY2UgPSAkKCcjcHJpY2UnKS52YWwoKTtcblxuXHRcdFx0Y29uc3QgZmlsdGVyZWRXaW5lTGlzdCA9IHByb2R1Y3RzLmZpbHRlcigocHJvZHVjdCkgPT4ge1xuXHRcdFx0XHRyZXR1cm4gcHJvZHVjdC5zZXJ2aW5nX3N1Z2dlc3Rpb24gIT0gbnVsbCAmJlxuXHRcdFx0XHRcdCAgIHByb2R1Y3QuaW1hZ2VfdXJsICE9IG51bGwgJiZcbiAgICBcdFx0XHRcdCAgIHByb2R1Y3QucHJpbWFyeV9jYXRlZ29yeSA9PT0gJ1dpbmUnICYmXG4gICAgXHRcdFx0XHQgICBwcm9kdWN0LnByaWNlX2luX2NlbnRzID49IHByaWNlIC0gNDAwICYmXG4gICAgXHRcdFx0XHQgICBwcm9kdWN0LnNlcnZpbmdfc3VnZ2VzdGlvbi5pbmRleE9mKGZvb2QpICE9IC0xICYmXG4gICAgXHRcdFx0XHQgICBwcm9kdWN0LnBhY2thZ2VfdW5pdF92b2x1bWVfaW5fbWlsbGlsaXRlcnMgPT09IDc1MDtcblx0XHRcdH0pO1xuXHRcdFx0Y29uc29sZS5sb2cocGFnZU51bWJlcik7XG5cdFx0XHRjb25zb2xlLmxvZyhmaWx0ZXJlZFdpbmVMaXN0KTtcblx0XHRcdFxuXHRcdFx0aWYgKGZpbHRlcmVkV2luZUxpc3QubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRjb25zdCByYW5kb21XaW5lID0gZmlsdGVyZWRXaW5lTGlzdFtNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqZmlsdGVyZWRXaW5lTGlzdC5sZW5ndGgpXTtcblx0XHRcdFx0Y29uc29sZS5sb2cocmFuZG9tV2luZSk7XG5cdFx0XHRcdHdpbmVBcHAuZGlzcGxheVdpbmUocmFuZG9tV2luZSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR3aW5lQXBwLmdldFdpbmVzKHNlYXJjaEZvb2QsIHNlYXJjaFByaWNlLCByYW5kb21QYWdlTnVtYmVyKTtcblx0XHRcdH1cblx0fSk7XG59XG5cbndpbmVBcHAuZGlzcGxheVdpbmUgPSAod2luZSkgPT4ge1xuXHQkKCcjbG9hZGVyJykucmVtb3ZlQ2xhc3MoXCJsb2FkZXJcIik7XG5cdCQoJyNsb2NhdGlvbnMnKS50b2dnbGUodHJ1ZSk7XG5cdGNvbnN0ICRuYW1lID0gJCgnPGgyPicpLnRleHQod2luZS5uYW1lKTtcblx0Y29uc3QgJHByb2R1Y2VyID0gJCgnPGgzPicpLnRleHQod2luZS5wcm9kdWNlcl9uYW1lKTtcblx0Y29uc3QgJHZhcmlldGFsID0gJCgnPHA+JykudGV4dCh3aW5lLnZhcmlldGFsKTtcblx0Y29uc3QgJHNlcnZpbmcgPSAkKCc8cD4nKS50ZXh0KHdpbmUuc2VydmluZ19zdWdnZXN0aW9uKTtcblx0Y29uc3QgJHRhc3RlID0gJCgnPHA+JykudGV4dCh3aW5lLnRhc3Rpbmdfbm90ZSk7XG5cdGNvbnN0ICRpbWdVUkwgPSAkKCc8aW1nPicpLmF0dHIoJ3NyYycsIHdpbmUuaW1hZ2VfdXJsKTtcblx0JCgnI3dpbmUnKS5hcHBlbmQoJG5hbWUsICRwcm9kdWNlciwgJHZhcmlldGFsLCAkdGFzdGUsICRzZXJ2aW5nLCAkaW1nVVJMKTtcblx0d2luZUFwcC5wcm9kdWN0SUQgPSB3aW5lLmlkO1xufVxuXG5cbndpbmVBcHAuZ2V0VXNlckNvb3JkcyA9ICgpID0+IHtcbiAgICBuYXZpZ2F0b3IuZ2VvbG9jYXRpb24uZ2V0Q3VycmVudFBvc2l0aW9uKGZ1bmN0aW9uKHBvc2l0aW9uKSB7XG4gICAgICAgIGNvbnN0IHVzZXJMYXQgPSBwb3NpdGlvbi5jb29yZHMubGF0aXR1ZGU7XG4gICAgICAgIGNvbnN0IHVzZXJMbmcgPSBwb3NpdGlvbi5jb29yZHMubG9uZ2l0dWRlO1xuICAgICAgICB3aW5lQXBwLmdldFN0b3Jlcyh3aW5lQXBwLnByb2R1Y3RJRCwgdXNlckxhdCwgdXNlckxuZyk7XG4gICAgfSk7XG59XG5cbndpbmVBcHAubXNtVG8yNHRpbWUgPSAobXNtKSA9PiB7XG4gICAgICAgIGNvbnN0IGhvdXIgPSBtc20gLyA2MDtcbiAgICAgICAgY29uc3QgbWlucyA9IG1zbSAlIDYwO1xuICAgICAgICBpZiAobWlucyA9PT0gMCkge1xuICAgICAgICAgICAgY29uc3QgdHdvWmVyb2VzID0gJzAwJ1xuICAgICAgICAgICAgcmV0dXJuIFtNYXRoLmZsb29yKGhvdXIpLCB0d29aZXJvZXNdO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICBcdHJldHVybiBbTWF0aC5mbG9vcihob3VyKSwgbWluc107XG4gICAgICAgIH1cbiAgICB9IFxud2luZUFwcC5tc21UbzEydGltZSA9IChtc20pID0+IHtcbiAgICAgICAgY29uc3QgdGltZSA9IHdpbmVBcHAubXNtVG8yNHRpbWUobXNtKTtcbiAgICAgICAgY29uc3QgaDI0ICA9IHRpbWVbMF07XG4gICAgICAgIGNvbnN0IGgxMiAgPSAoMCA9PSBoMjQgPyAxMiA6IChoMjQgPiAxMiA/IChoMjQgLSAxMCkgLSAyIDogaDI0KSk7XG4gICAgICAgIGNvbnN0IGFtcG0gPSAoaDI0ID49IDEyID8gJ1BNJyA6ICdBTScpO1xuXHRcdHJldHVybiBbaDEyLCB0aW1lWzFdLCBhbXBtXTtcbiAgICB9XG53aW5lQXBwLmdldFRpbWUgPSAobXNtKSA9PiB7XG4gICAgICAgIGNvbnN0IHRpbWUgPSB3aW5lQXBwLm1zbVRvMTJ0aW1lKG1zbSk7XG4gICAgICAgIGNvbnN0IG5ld1RpbWUgPSB0aW1lWzBdICsgJzonICsgdGltZVsxXSArIHRpbWVbMl07XG4gICAgICAgIHJldHVybiAobmV3VGltZSk7XG4gICAgfVxuXG5cbndpbmVBcHAuZ2V0U3RvcmVzID0gKGlkTnVtYmVyLCBsYXRpdHVkZSwgbG9uZ2l0dWRlKSA9PiB7XG5cdCQuYWpheCh7XG5cdFx0dXJsOiAnaHR0cHM6Ly9sY2JvYXBpLmNvbS9zdG9yZXMnLFxuXHRcdG1ldGhvZDogJ0dFVCcsXG5cdFx0ZGF0YVR5cGU6J2pzb24nLFxuXHRcdGhlYWRlcnM6IHtcblx0XHRcdCdBdXRob3JpemF0aW9uJzogJ1Rva2VuIE1Eb3habVl5TnpVNE1DMDNOV0UzTFRFeFpUZ3RZbVZtTXkwelltWTBOams0WkRJNVlUQTZjSGhCUkd3NVJXRm1Nalp1UWsxUGNXSmhaemcxVm01T016QkxhV3BrVG5OcVUwWlcnXG5cdFx0XHR9LFxuXHRcdGRhdGE6IHtcblx0XHRcdHByb2R1Y3RfaWQ6IGlkTnVtYmVyLFxuXHRcdFx0cGVyX3BhZ2U6IDEwLFxuXHRcdFx0bGF0OiBsYXRpdHVkZSxcblx0XHRcdGxvbjogbG9uZ2l0dWRlXG5cdFx0fVxuXHRcdH0pLnRoZW4oZnVuY3Rpb24ocmVzKSB7XHRcblx0XHRcdGNvbnN0IHN0b3JlcyA9IHJlcy5yZXN1bHQ7XG5cdFx0XHRjb25zb2xlLmxvZyhzdG9yZXMpO1xuXHRcdGlmIChzdG9yZXMubGVuZ3RoID09IDApIHtcblx0XHRcdFx0JCgnI21hcCcpLmFwcGVuZChgPGgxPlNvcnJ5LCBubyBzdG9yZXMgbmVhciB5b3UgY2FycnkgdGhpcyB3aW5lPC9oMT5gKVxuXHRcdH0gZWxzZSB7XG5cblx0XHRcdGNvbnN0IHVzZXJDb29yZHMgPSB7XG5cdFx0XHRcdGxhdDogbGF0aXR1ZGUsXG5cdFx0XHRcdGxuZzogbG9uZ2l0dWRlXG5cdFx0XHR9XG5cdFx0XHRjb25zdCBzdG9yZUluZm8gPSBbXVxuXHRcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCBzdG9yZXMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0c3RvcmVJbmZvW2ldID0ge1xuXHRcdFx0XHRcdGNvb3Jkczoge1xuXHRcdFx0XHRcdFx0bGF0OiBzdG9yZXNbaV0ubGF0aXR1ZGUsXG5cdFx0XHRcdFx0XHRsbmc6IHN0b3Jlc1tpXS5sb25naXR1ZGVcblx0XHRcdFx0XHR9LFx0XG5cdFx0XHRcdFx0c3RvcmVOYW1lOiBzdG9yZXNbaV0ubmFtZSxcblx0XHRcdFx0XHRob3Vyczoge1xuXHRcdFx0XHRcdFx0bW9uZGF5OiB7XG5cdFx0XHRcdFx0XHRcdG9wZW46IHdpbmVBcHAuZ2V0VGltZShzdG9yZXNbaV0ubW9uZGF5X29wZW4pLFxuXHRcdFx0XHRcdFx0XHRjbG9zZTogd2luZUFwcC5nZXRUaW1lKHN0b3Jlc1tpXS5tb25kYXlfY2xvc2UpXG5cdFx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdFx0dHVlc2RheToge1xuXHRcdFx0XHRcdFx0XHRvcGVuOiB3aW5lQXBwLmdldFRpbWUoc3RvcmVzW2ldLnR1ZXNkYXlfb3BlbiksXG5cdFx0XHRcdFx0XHRcdGNsb3NlOiB3aW5lQXBwLmdldFRpbWUoc3RvcmVzW2ldLnR1ZXNkYXlfY2xvc2UpXG5cdFx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdFx0d2VkbmVzZGF5OiB7XG5cdFx0XHRcdFx0XHRcdG9wZW46IHdpbmVBcHAuZ2V0VGltZShzdG9yZXNbaV0ud2VkbmVzZGF5X29wZW4pLFxuXHRcdFx0XHRcdFx0XHRjbG9zZTogd2luZUFwcC5nZXRUaW1lKHN0b3Jlc1tpXS53ZWRuZXNkYXlfY2xvc2UpXG5cdFx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdFx0dGh1cnNkYXk6IHtcblx0XHRcdFx0XHRcdFx0b3Blbjogd2luZUFwcC5nZXRUaW1lKHN0b3Jlc1tpXS50aHVyc2RheV9vcGVuKSxcblx0XHRcdFx0XHRcdFx0Y2xvc2U6IHdpbmVBcHAuZ2V0VGltZShzdG9yZXNbaV0udGh1cnNkYXlfY2xvc2UpXG5cdFx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdFx0ZnJpZGF5OiB7XG5cdFx0XHRcdFx0XHRcdG9wZW46IHdpbmVBcHAuZ2V0VGltZShzdG9yZXNbaV0uZnJpZGF5X29wZW4pLFxuXHRcdFx0XHRcdFx0XHRjbG9zZTogd2luZUFwcC5nZXRUaW1lKHN0b3Jlc1tpXS5mcmlkYXlfY2xvc2UpXG5cdFx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdFx0c2F0dXJkYXk6IHtcblx0XHRcdFx0XHRcdFx0b3Blbjogd2luZUFwcC5nZXRUaW1lKHN0b3Jlc1tpXS5zYXR1cmRheV9vcGVuKSxcblx0XHRcdFx0XHRcdFx0Y2xvc2U6IHdpbmVBcHAuZ2V0VGltZShzdG9yZXNbaV0uc2F0dXJkYXlfY2xvc2UpXG5cdFx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdFx0c3VuZGF5OiB7XG5cdFx0XHRcdFx0XHRcdG9wZW46IHdpbmVBcHAuZ2V0VGltZShzdG9yZXNbaV0uc3VuZGF5X29wZW4pLFxuXHRcdFx0XHRcdFx0XHRjbG9zZTogd2luZUFwcC5nZXRUaW1lKHN0b3Jlc1tpXS5zdW5kYXlfY2xvc2UpXG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRxdWFudGl0eTogc3RvcmVzW2ldLnF1YW50aXR5LFxuXHRcdFx0XHRcdGRpc3RhbmNlOiBzdG9yZXNbaV0uZGlzdGFuY2VfaW5fbWV0ZXJzLzEwMDAsXG5cdFx0XHRcdFx0YWRkcmVzczogc3RvcmVzW2ldLmFkZHJlc3NfbGluZV8xXHRcdFxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdHdpbmVBcHAubG9hZE1hcCh1c2VyQ29vcmRzLCBzdG9yZUluZm8pO1xuXHRcdFxuXHRcdH1cdFxuXHRcdH0pO1xufVxuXG53aW5lQXBwLmxvYWRNYXAgPSAoY2VudGVyQ29vcmRzLCBzdG9yZXNXaXRoUHJvZHVjdCkgPT4ge1xuXHQkKCcjbWFwJykudG9nZ2xlKHRydWUpO1x0XG5cdCQoJyNsaXN0JykudG9nZ2xlKHRydWUpO1xuXHRjb25zdCBtYXAgPSBuZXcgZ29vZ2xlLm1hcHMuTWFwKFxuXHRcdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXAnKSwge3pvb206IDEyLCBjZW50ZXI6IGNlbnRlckNvb3Jkc30pO1xuXHRjb25zdCBtYXJrZXJzID0gW107XG5cdGNvbnN0IGluZm9XaW5kb3cgPSBbXTtcblx0Y29uc3QgY29udGVudEhUTUwgPSBbXTtcblx0Y29uc3QgbG9jYXRpb25zSFRNTCA9IFtdO1xuXG5cblx0Zm9yIChsZXQgaSA9IDA7IGkgPCBzdG9yZXNXaXRoUHJvZHVjdC5sZW5ndGg7IGkrKykge1xuXHRcdGNvbnRlbnRIVE1MW2ldID0gYDxkaXYgaWQ9XCJjb250ZW50XyR7aX1cIj5cblx0XHRcdDxoMz4ke3N0b3Jlc1dpdGhQcm9kdWN0W2ldLnN0b3JlTmFtZX08L2gzPlxuXHRcdFx0PGgzPkhvdXJzPC9oMz5cblx0XHRcdDx1bD5cblx0XHRcdFx0PGxpPk1vbmRheTogJHtzdG9yZXNXaXRoUHJvZHVjdFtpXS5ob3Vycy5tb25kYXkub3Blbn0gLSAke3N0b3Jlc1dpdGhQcm9kdWN0W2ldLmhvdXJzLm1vbmRheS5jbG9zZX08L2xpPlxuXHRcdFx0XHQ8bGk+VHVlc2RheTogJHtzdG9yZXNXaXRoUHJvZHVjdFtpXS5ob3Vycy50dWVzZGF5Lm9wZW59IC0gJHtzdG9yZXNXaXRoUHJvZHVjdFtpXS5ob3Vycy50dWVzZGF5LmNsb3NlfTwvbGk+XG5cdFx0XHRcdDxsaT5XZWRuZXNkYXk6ICR7c3RvcmVzV2l0aFByb2R1Y3RbaV0uaG91cnMud2VkbmVzZGF5Lm9wZW59IC0gJHtzdG9yZXNXaXRoUHJvZHVjdFtpXS5ob3Vycy53ZWRuZXNkYXkuY2xvc2V9PC9saT5cblx0XHRcdFx0PGxpPlRodXJzZGF5OiAke3N0b3Jlc1dpdGhQcm9kdWN0W2ldLmhvdXJzLnRodXJzZGF5Lm9wZW59IC0gJHtzdG9yZXNXaXRoUHJvZHVjdFtpXS5ob3Vycy50aHVyc2RheS5jbG9zZX08L2xpPlxuXHRcdFx0XHQ8bGk+RnJpZGF5OiAke3N0b3Jlc1dpdGhQcm9kdWN0W2ldLmhvdXJzLmZyaWRheS5vcGVufSAtICR7c3RvcmVzV2l0aFByb2R1Y3RbaV0uaG91cnMuZnJpZGF5LmNsb3NlfTwvbGk+XG5cdFx0XHRcdDxsaT5TYXR1cmRheTogJHtzdG9yZXNXaXRoUHJvZHVjdFtpXS5ob3Vycy5zYXR1cmRheS5vcGVufSAtICR7c3RvcmVzV2l0aFByb2R1Y3RbaV0uaG91cnMuc2F0dXJkYXkuY2xvc2V9PC9saT5cblx0XHRcdFx0PGxpPlN1bmRheTogJHtzdG9yZXNXaXRoUHJvZHVjdFtpXS5ob3Vycy5zdW5kYXkub3Blbn0gLSAke3N0b3Jlc1dpdGhQcm9kdWN0W2ldLmhvdXJzLnN1bmRheS5jbG9zZX08L2xpPlxuXHRcdFx0PC91bD5cblx0XHRcdDxoMz5Cb3R0bGVzIGluIHN0b2NrOiAke3N0b3Jlc1dpdGhQcm9kdWN0W2ldLnF1YW50aXR5fTwvaDM+XG5cdFx0YDtcblx0XHRjb25zdCB1c2VyTWFya2VyID0gbmV3IGdvb2dsZS5tYXBzLk1hcmtlcihcblx0XHRcdHtcblx0XHRcdFx0cG9zaXRpb246IGNlbnRlckNvb3JkcywgXG5cdFx0XHRcdG1hcDogbWFwXG5cdFx0XHR9XG5cdFx0KTtcblx0XHRtYXJrZXJzW2ldID0gbmV3IGdvb2dsZS5tYXBzLk1hcmtlcihcblx0XHRcdHtcblx0XHRcdFx0cG9zaXRpb246IHN0b3Jlc1dpdGhQcm9kdWN0W2ldLmNvb3JkcywgXG5cdFx0XHRcdGxhYmVsOiBgJHtpKzF9YCxcblx0XHRcdFx0bWFwOiBtYXBcblx0XHRcdH1cblx0XHQpO1xuICAgICAgICBpbmZvV2luZG93W2ldID0gbmV3IGdvb2dsZS5tYXBzLkluZm9XaW5kb3coe1xuICAgICAgICBcdGNvbnRlbnQ6IGNvbnRlbnRIVE1MW2ldXG4gICAgICAgIH0pO1xuICAgICAgICBtYXJrZXJzW2ldLmFkZExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuICAgICAgICBcdGluZm9XaW5kb3dbaV0ub3BlbihtYXAsIG1hcmtlcnNbaV0pO1xuICAgICAgICB9KTtcbiAgICAgICAgbG9jYXRpb25zSFRNTFtpXSA9IGBcblx0XHQ8bGk+XG5cdFx0XHQ8aDM+JHtzdG9yZXNXaXRoUHJvZHVjdFtpXS5zdG9yZU5hbWV9PC9oMz5cblx0XHRcdDxwPiR7c3RvcmVzV2l0aFByb2R1Y3RbaV0uYWRkcmVzc308L3A+XG5cdFx0XHQ8cD4ke3N0b3Jlc1dpdGhQcm9kdWN0W2ldLmRpc3RhbmNlfWttIGF3YXk8L3A+XG5cdFx0XHQ8cD4ke3N0b3Jlc1dpdGhQcm9kdWN0W2ldLnF1YW50aXR5fSBib3R0bGVzIGluIHN0b2NrPC9wPlxuXHRcdDwvbGk+XG4gICAgICAgIGBcbiAgICAgICAgJCgnI2xpc3QnKS5hcHBlbmQobG9jYXRpb25zSFRNTFtpXSk7XG5cdH1cbn1cblxud2luZUFwcC5pbml0ID0gKCkgPT4ge1xuXHQkKCcjd2luZUJ1dHRvbicpLm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0JCgnI2xvYWRlcicpLmFkZENsYXNzKFwibG9hZGVyXCIpO1xuXHRcdCQoJyNsb2NhdGlvbnMnKS50b2dnbGUoZmFsc2UpO1xuXHRcdCQoJyN3aW5lJykuZW1wdHkoKTtcblx0XHRzZWFyY2hGb29kID0gJCgnI2Zvb2QnKS52YWwoKTtcblx0XHRzZWFyY2hQcmljZSA9ICQoJyNwcmljZScpLnZhbCgpO1xuXHRcdGNvbnNvbGUubG9nKHNlYXJjaEZvb2QgKyBzZWFyY2hQcmljZSk7XG5cdFx0d2luZUFwcC5nZXRXaW5lcyhzZWFyY2hGb29kLCBzZWFyY2hQcmljZSwgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKjEwMCkpO1xuXHR9KTtcdFxuXHQkKCcjc3RvcmVCdXR0b24nKS5vbignY2xpY2snLCBmdW5jdGlvbihlKSB7XG5cdFx0d2luZUFwcC5nZXRVc2VyQ29vcmRzKCk7XG5cdH0pO1xufVxuXG4kKGZ1bmN0aW9uKCkge1xuXHR3aW5lQXBwLmluaXQoKTtcbn0pO1xuXG5cbi8vIDEuIGhvdyB0byBsb29wIHRocm91Z2ggZnVuY3Rpb24gb24gaG93IG1hbnkgcGFnZXMgZXhpc3Rcbi8vIDIuIGhvdyB0byBydW4gZmxhdHRlbkFycmF5IGFmdGVyIGdldEFsbFdpbmVzIChwcm9taXNlcz8pXG4iXX0=
