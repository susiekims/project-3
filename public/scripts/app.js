(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
'use strict';

var wineApp = {};
wineApp.productID;

var searchFood = void 0;
var searchPrice = void 0;

wineApp.getWines = function (food, price, pageNumber) {
	$('#map').toggle(false);
	var randomPageNumber = Math.floor(Math.random() * 100);
	$.ajax({
		url: 'https://lcboapi.com/products',
		method: 'GET',
		dataType: 'json',
		headers: {
			'Authorization': 'Token MDoxZmYyNzU4MC03NWE3LTExZTgtYmVmMy0zYmY0Njk4ZDI5YTA6cHhBRGw5RWFmMjZuQk1PcWJhZzg1Vm5OMzBLaWpkTnNqU0ZW'
		},
		data: {
			per_page: 100,
			page: pageNumber,
			q: 'wine'
		}
	}).then(function (res) {
		var products = res.result;
		searchFood = $('#food').val();
		searchPrice = $('#price').val();

		var filteredWineList = products.filter(function (product) {
			return product.serving_suggestion != null && product.image_url != null && product.primary_category === 'Wine' && product.price_in_cents >= price - 400 && product.serving_suggestion.indexOf(food) != -1 && product.package_unit_volume_in_milliliters === 750;
		});
		console.log(pageNumber);
		console.log(filteredWineList);

		if (filteredWineList.length > 0) {
			var randomWine = filteredWineList[Math.floor(Math.random() * filteredWineList.length)];
			console.log(randomWine);
			wineApp.displayWine(randomWine);
		} else {
			wineApp.getWines(searchFood, searchPrice, randomPageNumber);
		}
	});
};

wineApp.displayWine = function (wine) {
	$('#loader').removeClass("loader");
	$('#locations').toggle(true);
	var $name = $('<h2>').text(wine.name);
	var $producer = $('<h3>').text(wine.producer_name);
	var $varietal = $('<p>').text(wine.varietal);
	var $taste = $('<p>').text(wine.tasting_note);
	var $imgURL = $('<img>').attr('src', wine.image_url);
	$('#wine').append($name, $producer, $varietal, $taste, $imgURL);
	wineApp.productID = wine.id;
};

wineApp.getUserCoords = function () {
	navigator.geolocation.getCurrentPosition(function (position) {
		var userLat = position.coords.latitude;
		var userLng = position.coords.longitude;
		wineApp.getStores(wineApp.productID, userLat, userLng);
	});
};

wineApp.msmTo24time = function (msm) {
	var hour = msm / 60;
	var mins = msm % 60;
	if (mins === 0) {
		var twoZeroes = '00';
		return [Math.floor(hour), twoZeroes];
	} else {
		return [Math.floor(hour), mins];
	}
};
wineApp.msmTo12time = function (msm) {
	var time = wineApp.msmTo24time(msm);
	var h24 = time[0];
	var h12 = 0 == h24 ? 12 : h24 > 12 ? h24 - 10 - 2 : h24;
	var ampm = h24 >= 12 ? 'PM' : 'AM';
	return [h12, time[1], ampm];
};
wineApp.getTime = function (msm) {
	var time = wineApp.msmTo12time(msm);
	var newTime = time[0] + ':' + time[1] + time[2];
	return newTime;
};

wineApp.getStores = function (idNumber, latitude, longitude) {
	$.ajax({
		url: 'https://lcboapi.com/stores',
		method: 'GET',
		dataType: 'json',
		headers: {
			'Authorization': 'Token MDoxZmYyNzU4MC03NWE3LTExZTgtYmVmMy0zYmY0Njk4ZDI5YTA6cHhBRGw5RWFmMjZuQk1PcWJhZzg1Vm5OMzBLaWpkTnNqU0ZW'
		},
		data: {
			product_id: idNumber,
			per_page: 10,
			lat: latitude,
			lon: longitude
		}
	}).then(function (res) {
		var stores = res.result;
		console.log(stores);
		var userCoords = {
			lat: latitude,
			lng: longitude
		};
		var storeInfo = [];
		for (var i = 0; i < stores.length; i++) {
			storeInfo[i] = {
				coords: {
					lat: stores[i].latitude,
					lng: stores[i].longitude
				},
				storeName: stores[i].name,
				hours: {
					monday: {
						open: wineApp.getTime(stores[i].monday_open),
						close: wineApp.getTime(stores[i].monday_close)
					},
					tuesday: {
						open: wineApp.getTime(stores[i].tuesday_open),
						close: wineApp.getTime(stores[i].tuesday_close)
					},
					wednesday: {
						open: wineApp.getTime(stores[i].wednesday_open),
						close: wineApp.getTime(stores[i].wednesday_close)
					},
					thursday: {
						open: wineApp.getTime(stores[i].thursday_open),
						close: wineApp.getTime(stores[i].thursday_close)
					},
					friday: {
						open: wineApp.getTime(stores[i].friday_open),
						close: wineApp.getTime(stores[i].friday_close)
					},
					saturday: {
						open: wineApp.getTime(stores[i].saturday_open),
						close: wineApp.getTime(stores[i].saturday_close)
					},
					sunday: {
						open: wineApp.getTime(stores[i].sunday_open),
						close: wineApp.getTime(stores[i].sunday_close)
					}
				},
				quantity: stores[i].quantity
			};
		}

		wineApp.loadMap(userCoords, storeInfo);
	});
};

wineApp.loadMap = function (centerCoords, storesWithProduct) {
	$('#map').toggle(true);
	var map = new google.maps.Map(document.getElementById('map'), { zoom: 12, center: centerCoords });
	var markers = [];
	var infoWindow = [];
	var content = [];

	var _loop = function _loop(i) {
		content[i] = '<div id="content_' + i + '">\n\t\t\t<h3>' + storesWithProduct[i].storeName + '</h3>\n\t\t\t<h3>Hours</h3>\n\t\t\t<ul>\n\t\t\t\t<li>Monday: ' + storesWithProduct[i].hours.monday.open + ' - ' + storesWithProduct[i].hours.monday.close + '</li>\n\t\t\t\t<li>Tuesday: ' + storesWithProduct[i].hours.tuesday.open + ' - ' + storesWithProduct[i].hours.tuesday.close + '</li>\n\t\t\t\t<li>Wednesday: ' + storesWithProduct[i].hours.wednesday.open + ' - ' + storesWithProduct[i].hours.wednesday.close + '</li>\n\t\t\t\t<li>Thursday: ' + storesWithProduct[i].hours.thursday.open + ' - ' + storesWithProduct[i].hours.thursday.close + '</li>\n\t\t\t\t<li>Friday: ' + storesWithProduct[i].hours.friday.open + ' - ' + storesWithProduct[i].hours.friday.close + '</li>\n\t\t\t\t<li>Saturday: ' + storesWithProduct[i].hours.saturday.open + ' - ' + storesWithProduct[i].hours.saturday.close + '</li>\n\t\t\t\t<li>Sunday: ' + storesWithProduct[i].hours.sunday.open + ' - ' + storesWithProduct[i].hours.sunday.close + '</li>\n\t\t\t</ul>\n\t\t\t<h3>Bottles in stock: ' + storesWithProduct[i].quantity + '</h3>\n\t\t';
		markers[i] = new google.maps.Marker({
			position: storesWithProduct[i].coords,
			label: '' + (i + 1),
			map: map
		});
		infoWindow[i] = new google.maps.InfoWindow({
			content: content[i]
		});
		markers[i].addListener('click', function () {
			infoWindow[i].open(map, markers[i]);
		});
	};

	for (var i = 0; i < storesWithProduct.length; i++) {
		_loop(i);
	}
};

wineApp.init = function () {
	$('#wineButton').on('click', function (e) {
		e.preventDefault();
		$('#loader').addClass("loader");
		$('#locations').toggle(false);
		$('#wine').empty();
		searchFood = $('#food').val();
		searchPrice = $('#price').val();
		console.log(searchFood + searchPrice);
		wineApp.getWines(searchFood, searchPrice, Math.floor(Math.random() * 100));
	});
	$('#storeButton').on('click', function (e) {
		wineApp.getUserCoords();
		console.log(wineApp.getTime(570));
	});
};

$(function () {
	wineApp.init();
});

// 1. how to loop through function on how many pages exist
// 2. how to run flattenArray after getAllWines (promises?)

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJkZXYvc2NyaXB0cy9hcHAuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7OztBQ0FBLElBQU0sVUFBVSxFQUFoQjtBQUNBLFFBQVEsU0FBUjs7QUFFQSxJQUFJLG1CQUFKO0FBQ0EsSUFBSSxvQkFBSjs7QUFFQSxRQUFRLFFBQVIsR0FBbUIsVUFBQyxJQUFELEVBQU8sS0FBUCxFQUFjLFVBQWQsRUFBNkI7QUFDaEQsR0FBRSxNQUFGLEVBQVUsTUFBVixDQUFpQixLQUFqQjtBQUNBLEtBQU0sbUJBQW1CLEtBQUssS0FBTCxDQUFXLEtBQUssTUFBTCxLQUFjLEdBQXpCLENBQXpCO0FBQ0MsR0FBRSxJQUFGLENBQU87QUFDTixPQUFLLDhCQURDO0FBRU4sVUFBUSxLQUZGO0FBR04sWUFBUyxNQUhIO0FBSU4sV0FBUztBQUNSLG9CQUFpQjtBQURULEdBSkg7QUFPTixRQUFNO0FBQ0wsYUFBVSxHQURMO0FBRUwsU0FBTSxVQUZEO0FBR0wsTUFBRztBQUhFO0FBUEEsRUFBUCxFQVlJLElBWkosQ0FZUyxVQUFTLEdBQVQsRUFBYztBQUNyQixNQUFNLFdBQVcsSUFBSSxNQUFyQjtBQUNBLGVBQWEsRUFBRSxPQUFGLEVBQVcsR0FBWCxFQUFiO0FBQ0EsZ0JBQWMsRUFBRSxRQUFGLEVBQVksR0FBWixFQUFkOztBQUVBLE1BQU0sbUJBQW1CLFNBQVMsTUFBVCxDQUFnQixVQUFDLE9BQUQsRUFBYTtBQUNyRCxVQUFPLFFBQVEsa0JBQVIsSUFBOEIsSUFBOUIsSUFDSCxRQUFRLFNBQVIsSUFBcUIsSUFEbEIsSUFFQSxRQUFRLGdCQUFSLEtBQTZCLE1BRjdCLElBR0EsUUFBUSxjQUFSLElBQTBCLFFBQVEsR0FIbEMsSUFJQSxRQUFRLGtCQUFSLENBQTJCLE9BQTNCLENBQW1DLElBQW5DLEtBQTRDLENBQUMsQ0FKN0MsSUFLQSxRQUFRLGtDQUFSLEtBQStDLEdBTHREO0FBTUEsR0FQd0IsQ0FB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TUFBTCxLQUFjLEdBQXpCLENBQTFDO0FBQ0EsRUFURDtBQVVBLEdBQUUsY0FBRixFQUFrQixFQUFsQixDQUFxQixPQUFyQixFQUE4QixVQUFTLENBQVQsRUFBWTtBQUN6QyxVQUFRLGFBQVI7QUFDQSxVQUFRLEdBQVIsQ0FBWSxRQUFRLE9BQVIsQ0FBZ0IsR0FBaEIsQ0FBWjtBQUNBLEVBSEQ7QUFJQSxDQWZEOztBQWlCQSxFQUFFLFlBQVc7QUFDWixTQUFRLElBQVI7QUFDQSxDQUZEOztBQUtBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpe2Z1bmN0aW9uIHIoZSxuLHQpe2Z1bmN0aW9uIG8oaSxmKXtpZighbltpXSl7aWYoIWVbaV0pe3ZhciBjPVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmU7aWYoIWYmJmMpcmV0dXJuIGMoaSwhMCk7aWYodSlyZXR1cm4gdShpLCEwKTt2YXIgYT1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK2krXCInXCIpO3Rocm93IGEuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixhfXZhciBwPW5baV09e2V4cG9ydHM6e319O2VbaV1bMF0uY2FsbChwLmV4cG9ydHMsZnVuY3Rpb24ocil7dmFyIG49ZVtpXVsxXVtyXTtyZXR1cm4gbyhufHxyKX0scCxwLmV4cG9ydHMscixlLG4sdCl9cmV0dXJuIG5baV0uZXhwb3J0c31mb3IodmFyIHU9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZSxpPTA7aTx0Lmxlbmd0aDtpKyspbyh0W2ldKTtyZXR1cm4gb31yZXR1cm4gcn0pKCkiLCJjb25zdCB3aW5lQXBwID0ge31cbndpbmVBcHAucHJvZHVjdElEO1xuXG5sZXQgc2VhcmNoRm9vZCA7XG5sZXQgc2VhcmNoUHJpY2UgO1xuXG53aW5lQXBwLmdldFdpbmVzID0gKGZvb2QsIHByaWNlLCBwYWdlTnVtYmVyKSA9PiB7XG4kKCcjbWFwJykudG9nZ2xlKGZhbHNlKTtcdFxuY29uc3QgcmFuZG9tUGFnZU51bWJlciA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSoxMDApO1x0XG5cdCQuYWpheCh7XG5cdFx0dXJsOiAnaHR0cHM6Ly9sY2JvYXBpLmNvbS9wcm9kdWN0cycsXG5cdFx0bWV0aG9kOiAnR0VUJyxcblx0XHRkYXRhVHlwZTonanNvbicsXG5cdFx0aGVhZGVyczoge1xuXHRcdFx0J0F1dGhvcml6YXRpb24nOiAnVG9rZW4gTURveFptWXlOelU0TUMwM05XRTNMVEV4WlRndFltVm1NeTB6WW1ZME5qazRaREk1WVRBNmNIaEJSR3c1UldGbU1qWnVRazFQY1dKaFp6ZzFWbTVPTXpCTGFXcGtUbk5xVTBaVydcblx0XHRcdH0sXG5cdFx0ZGF0YToge1xuXHRcdFx0cGVyX3BhZ2U6IDEwMCxcblx0XHRcdHBhZ2U6IHBhZ2VOdW1iZXIsXG5cdFx0XHRxOiAnd2luZScsXG5cdFx0fVxuXHRcdH0pLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG5cdFx0XHRjb25zdCBwcm9kdWN0cyA9IHJlcy5yZXN1bHQ7XG5cdFx0XHRzZWFyY2hGb29kID0gJCgnI2Zvb2QnKS52YWwoKTtcblx0XHRcdHNlYXJjaFByaWNlID0gJCgnI3ByaWNlJykudmFsKCk7XG5cblx0XHRcdGNvbnN0IGZpbHRlcmVkV2luZUxpc3QgPSBwcm9kdWN0cy5maWx0ZXIoKHByb2R1Y3QpID0+IHtcblx0XHRcdFx0cmV0dXJuIHByb2R1Y3Quc2VydmluZ19zdWdnZXN0aW9uICE9IG51bGwgJiZcblx0XHRcdFx0XHQgICBwcm9kdWN0LmltYWdlX3VybCAhPSBudWxsICYmXG4gICAgXHRcdFx0XHQgICBwcm9kdWN0LnByaW1hcnlfY2F0ZWdvcnkgPT09ICdXaW5lJyAmJlxuICAgIFx0XHRcdFx0ICAgcHJvZHVjdC5wcmljZV9pbl9jZW50cyA+PSBwcmljZSAtIDQwMCAmJlxuICAgIFx0XHRcdFx0ICAgcHJvZHVjdC5zZXJ2aW5nX3N1Z2dlc3Rpb24uaW5kZXhPZihmb29kKSAhPSAtMSAmJlxuICAgIFx0XHRcdFx0ICAgcHJvZHVjdC5wYWNrYWdlX3VuaXRfdm9sdW1lX2luX21pbGxpbGl0ZXJzID09PSA3NTA7XG5cdFx0XHR9KTtcblx0XHRcdGNvbnNvbGUubG9nKHBhZ2VOdW1iZXIpO1xuXHRcdFx0Y29uc29sZS5sb2coZmlsdGVyZWRXaW5lTGlzdCk7XG5cdFx0XHRcblx0XHRcdGlmIChmaWx0ZXJlZFdpbmVMaXN0Lmxlbmd0aCA+IDApIHtcblx0XHRcdFx0Y29uc3QgcmFuZG9tV2luZSA9IGZpbHRlcmVkV2luZUxpc3RbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKmZpbHRlcmVkV2luZUxpc3QubGVuZ3RoKV07XG5cdFx0XHRcdGNvbnNvbGUubG9nKHJhbmRvbVdpbmUpO1xuXHRcdFx0XHR3aW5lQXBwLmRpc3BsYXlXaW5lKHJhbmRvbVdpbmUpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0d2luZUFwcC5nZXRXaW5lcyhzZWFyY2hGb29kLCBzZWFyY2hQcmljZSwgcmFuZG9tUGFnZU51bWJlcik7XG5cdFx0XHR9XG5cdH0pO1xufVxuXG53aW5lQXBwLmRpc3BsYXlXaW5lID0gKHdpbmUpID0+IHtcblx0JCgnI2xvYWRlcicpLnJlbW92ZUNsYXNzKFwibG9hZGVyXCIpO1xuXHQkKCcjbG9jYXRpb25zJykudG9nZ2xlKHRydWUpO1xuXHRjb25zdCAkbmFtZSA9ICQoJzxoMj4nKS50ZXh0KHdpbmUubmFtZSk7XG5cdGNvbnN0ICRwcm9kdWNlciA9ICQoJzxoMz4nKS50ZXh0KHdpbmUucHJvZHVjZXJfbmFtZSk7XG5cdGNvbnN0ICR2YXJpZXRhbCA9ICQoJzxwPicpLnRleHQod2luZS52YXJpZXRhbCk7XG5cdGNvbnN0ICR0YXN0ZSA9ICQoJzxwPicpLnRleHQod2luZS50YXN0aW5nX25vdGUpO1xuXHRjb25zdCAkaW1nVVJMID0gJCgnPGltZz4nKS5hdHRyKCdzcmMnLCB3aW5lLmltYWdlX3VybCk7XG5cdCQoJyN3aW5lJykuYXBwZW5kKCRuYW1lLCAkcHJvZHVjZXIsICR2YXJpZXRhbCwgJHRhc3RlLCAkaW1nVVJMKTtcblx0d2luZUFwcC5wcm9kdWN0SUQgPSB3aW5lLmlkO1xufVxuXG5cbndpbmVBcHAuZ2V0VXNlckNvb3JkcyA9ICgpID0+IHtcbiAgICBuYXZpZ2F0b3IuZ2VvbG9jYXRpb24uZ2V0Q3VycmVudFBvc2l0aW9uKGZ1bmN0aW9uKHBvc2l0aW9uKSB7XG4gICAgICAgIGNvbnN0IHVzZXJMYXQgPSBwb3NpdGlvbi5jb29yZHMubGF0aXR1ZGU7XG4gICAgICAgIGNvbnN0IHVzZXJMbmcgPSBwb3NpdGlvbi5jb29yZHMubG9uZ2l0dWRlO1xuICAgICAgICB3aW5lQXBwLmdldFN0b3Jlcyh3aW5lQXBwLnByb2R1Y3RJRCwgdXNlckxhdCwgdXNlckxuZyk7XG4gICAgfSk7XG59XG5cbndpbmVBcHAubXNtVG8yNHRpbWUgPSAobXNtKSA9PiB7XG4gICAgICAgIGNvbnN0IGhvdXIgPSBtc20gLyA2MDtcbiAgICAgICAgY29uc3QgbWlucyA9IG1zbSAlIDYwO1xuICAgICAgICBpZiAobWlucyA9PT0gMCkge1xuICAgICAgICAgICAgY29uc3QgdHdvWmVyb2VzID0gJzAwJ1xuICAgICAgICAgICAgcmV0dXJuIFtNYXRoLmZsb29yKGhvdXIpLCB0d29aZXJvZXNdO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICBcdHJldHVybiBbTWF0aC5mbG9vcihob3VyKSwgbWluc107XG4gICAgICAgIH1cbiAgICB9IFxud2luZUFwcC5tc21UbzEydGltZSA9IChtc20pID0+IHtcbiAgICAgICAgY29uc3QgdGltZSA9IHdpbmVBcHAubXNtVG8yNHRpbWUobXNtKTtcbiAgICAgICAgY29uc3QgaDI0ICA9IHRpbWVbMF07XG4gICAgICAgIGNvbnN0IGgxMiAgPSAoMCA9PSBoMjQgPyAxMiA6IChoMjQgPiAxMiA/IChoMjQgLSAxMCkgLSAyIDogaDI0KSk7XG4gICAgICAgIGNvbnN0IGFtcG0gPSAoaDI0ID49IDEyID8gJ1BNJyA6ICdBTScpO1xuXHRcdHJldHVybiBbaDEyLCB0aW1lWzFdLCBhbXBtXTtcbiAgICB9XG53aW5lQXBwLmdldFRpbWUgPSAobXNtKSA9PiB7XG4gICAgICAgIGNvbnN0IHRpbWUgPSB3aW5lQXBwLm1zbVRvMTJ0aW1lKG1zbSk7XG4gICAgICAgIGNvbnN0IG5ld1RpbWUgPSB0aW1lWzBdICsgJzonICsgdGltZVsxXSArIHRpbWVbMl07XG4gICAgICAgIHJldHVybiAobmV3VGltZSk7XG4gICAgfVxuXG5cbndpbmVBcHAuZ2V0U3RvcmVzID0gKGlkTnVtYmVyLCBsYXRpdHVkZSwgbG9uZ2l0dWRlKSA9PiB7XG5cdCQuYWpheCh7XG5cdFx0dXJsOiAnaHR0cHM6Ly9sY2JvYXBpLmNvbS9zdG9yZXMnLFxuXHRcdG1ldGhvZDogJ0dFVCcsXG5cdFx0ZGF0YVR5cGU6J2pzb24nLFxuXHRcdGhlYWRlcnM6IHtcblx0XHRcdCdBdXRob3JpemF0aW9uJzogJ1Rva2VuIE1Eb3habVl5TnpVNE1DMDNOV0UzTFRFeFpUZ3RZbVZtTXkwelltWTBOams0WkRJNVlUQTZjSGhCUkd3NVJXRm1Nalp1UWsxUGNXSmhaemcxVm01T016QkxhV3BrVG5OcVUwWlcnXG5cdFx0XHR9LFxuXHRcdGRhdGE6IHtcblx0XHRcdHByb2R1Y3RfaWQ6IGlkTnVtYmVyLFxuXHRcdFx0cGVyX3BhZ2U6IDEwLFxuXHRcdFx0bGF0OiBsYXRpdHVkZSxcblx0XHRcdGxvbjogbG9uZ2l0dWRlXG5cdFx0fVxuXHRcdH0pLnRoZW4oZnVuY3Rpb24ocmVzKSB7XHRcblx0XHRcdGNvbnN0IHN0b3JlcyA9IHJlcy5yZXN1bHQ7XG5cdFx0XHRjb25zb2xlLmxvZyhzdG9yZXMpO1xuXHRcdFx0Y29uc3QgdXNlckNvb3JkcyA9IHtcblx0XHRcdFx0bGF0OiBsYXRpdHVkZSxcblx0XHRcdFx0bG5nOiBsb25naXR1ZGVcblx0XHRcdH1cblx0XHRcdGNvbnN0IHN0b3JlSW5mbyA9IFtdXG5cdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IHN0b3Jlcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRzdG9yZUluZm9baV0gPSB7XG5cdFx0XHRcdFx0Y29vcmRzOiB7XG5cdFx0XHRcdFx0XHRsYXQ6IHN0b3Jlc1tpXS5sYXRpdHVkZSxcblx0XHRcdFx0XHRcdGxuZzogc3RvcmVzW2ldLmxvbmdpdHVkZVxuXHRcdFx0XHRcdH0sXHRcblx0XHRcdFx0XHRzdG9yZU5hbWU6IHN0b3Jlc1tpXS5uYW1lLFxuXHRcdFx0XHRcdGhvdXJzOiB7XG5cdFx0XHRcdFx0XHRtb25kYXk6IHtcblx0XHRcdFx0XHRcdFx0b3Blbjogd2luZUFwcC5nZXRUaW1lKHN0b3Jlc1tpXS5tb25kYXlfb3BlbiksXG5cdFx0XHRcdFx0XHRcdGNsb3NlOiB3aW5lQXBwLmdldFRpbWUoc3RvcmVzW2ldLm1vbmRheV9jbG9zZSlcblx0XHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0XHR0dWVzZGF5OiB7XG5cdFx0XHRcdFx0XHRcdG9wZW46IHdpbmVBcHAuZ2V0VGltZShzdG9yZXNbaV0udHVlc2RheV9vcGVuKSxcblx0XHRcdFx0XHRcdFx0Y2xvc2U6IHdpbmVBcHAuZ2V0VGltZShzdG9yZXNbaV0udHVlc2RheV9jbG9zZSlcblx0XHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0XHR3ZWRuZXNkYXk6IHtcblx0XHRcdFx0XHRcdFx0b3Blbjogd2luZUFwcC5nZXRUaW1lKHN0b3Jlc1tpXS53ZWRuZXNkYXlfb3BlbiksXG5cdFx0XHRcdFx0XHRcdGNsb3NlOiB3aW5lQXBwLmdldFRpbWUoc3RvcmVzW2ldLndlZG5lc2RheV9jbG9zZSlcblx0XHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0XHR0aHVyc2RheToge1xuXHRcdFx0XHRcdFx0XHRvcGVuOiB3aW5lQXBwLmdldFRpbWUoc3RvcmVzW2ldLnRodXJzZGF5X29wZW4pLFxuXHRcdFx0XHRcdFx0XHRjbG9zZTogd2luZUFwcC5nZXRUaW1lKHN0b3Jlc1tpXS50aHVyc2RheV9jbG9zZSlcblx0XHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0XHRmcmlkYXk6IHtcblx0XHRcdFx0XHRcdFx0b3Blbjogd2luZUFwcC5nZXRUaW1lKHN0b3Jlc1tpXS5mcmlkYXlfb3BlbiksXG5cdFx0XHRcdFx0XHRcdGNsb3NlOiB3aW5lQXBwLmdldFRpbWUoc3RvcmVzW2ldLmZyaWRheV9jbG9zZSlcblx0XHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0XHRzYXR1cmRheToge1xuXHRcdFx0XHRcdFx0XHRvcGVuOiB3aW5lQXBwLmdldFRpbWUoc3RvcmVzW2ldLnNhdHVyZGF5X29wZW4pLFxuXHRcdFx0XHRcdFx0XHRjbG9zZTogd2luZUFwcC5nZXRUaW1lKHN0b3Jlc1tpXS5zYXR1cmRheV9jbG9zZSlcblx0XHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0XHRzdW5kYXk6IHtcblx0XHRcdFx0XHRcdFx0b3Blbjogd2luZUFwcC5nZXRUaW1lKHN0b3Jlc1tpXS5zdW5kYXlfb3BlbiksXG5cdFx0XHRcdFx0XHRcdGNsb3NlOiB3aW5lQXBwLmdldFRpbWUoc3RvcmVzW2ldLnN1bmRheV9jbG9zZSlcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdHF1YW50aXR5OiBzdG9yZXNbaV0ucXVhbnRpdHlcdFx0XHRcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHR3aW5lQXBwLmxvYWRNYXAodXNlckNvb3Jkcywgc3RvcmVJbmZvKTtcblx0XHR9KTtcbn1cblxud2luZUFwcC5sb2FkTWFwID0gKGNlbnRlckNvb3Jkcywgc3RvcmVzV2l0aFByb2R1Y3QpID0+IHtcblx0JCgnI21hcCcpLnRvZ2dsZSh0cnVlKTtcdFxuXHRjb25zdCBtYXAgPSBuZXcgZ29vZ2xlLm1hcHMuTWFwKFxuXHRcdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXAnKSwge3pvb206IDEyLCBjZW50ZXI6IGNlbnRlckNvb3Jkc30pO1xuXHRjb25zdCBtYXJrZXJzID0gW107XG5cdGNvbnN0IGluZm9XaW5kb3cgPSBbXTtcblx0Y29uc3QgY29udGVudCA9IFtdO1xuXHRmb3IgKGxldCBpID0gMDsgaSA8IHN0b3Jlc1dpdGhQcm9kdWN0Lmxlbmd0aDsgaSsrKSB7XG5cdFx0Y29udGVudFtpXSA9IGA8ZGl2IGlkPVwiY29udGVudF8ke2l9XCI+XG5cdFx0XHQ8aDM+JHtzdG9yZXNXaXRoUHJvZHVjdFtpXS5zdG9yZU5hbWV9PC9oMz5cblx0XHRcdDxoMz5Ib3VyczwvaDM+XG5cdFx0XHQ8dWw+XG5cdFx0XHRcdDxsaT5Nb25kYXk6ICR7c3RvcmVzV2l0aFByb2R1Y3RbaV0uaG91cnMubW9uZGF5Lm9wZW59IC0gJHtzdG9yZXNXaXRoUHJvZHVjdFtpXS5ob3Vycy5tb25kYXkuY2xvc2V9PC9saT5cblx0XHRcdFx0PGxpPlR1ZXNkYXk6ICR7c3RvcmVzV2l0aFByb2R1Y3RbaV0uaG91cnMudHVlc2RheS5vcGVufSAtICR7c3RvcmVzV2l0aFByb2R1Y3RbaV0uaG91cnMudHVlc2RheS5jbG9zZX08L2xpPlxuXHRcdFx0XHQ8bGk+V2VkbmVzZGF5OiAke3N0b3Jlc1dpdGhQcm9kdWN0W2ldLmhvdXJzLndlZG5lc2RheS5vcGVufSAtICR7c3RvcmVzV2l0aFByb2R1Y3RbaV0uaG91cnMud2VkbmVzZGF5LmNsb3NlfTwvbGk+XG5cdFx0XHRcdDxsaT5UaHVyc2RheTogJHtzdG9yZXNXaXRoUHJvZHVjdFtpXS5ob3Vycy50aHVyc2RheS5vcGVufSAtICR7c3RvcmVzV2l0aFByb2R1Y3RbaV0uaG91cnMudGh1cnNkYXkuY2xvc2V9PC9saT5cblx0XHRcdFx0PGxpPkZyaWRheTogJHtzdG9yZXNXaXRoUHJvZHVjdFtpXS5ob3Vycy5mcmlkYXkub3Blbn0gLSAke3N0b3Jlc1dpdGhQcm9kdWN0W2ldLmhvdXJzLmZyaWRheS5jbG9zZX08L2xpPlxuXHRcdFx0XHQ8bGk+U2F0dXJkYXk6ICR7c3RvcmVzV2l0aFByb2R1Y3RbaV0uaG91cnMuc2F0dXJkYXkub3Blbn0gLSAke3N0b3Jlc1dpdGhQcm9kdWN0W2ldLmhvdXJzLnNhdHVyZGF5LmNsb3NlfTwvbGk+XG5cdFx0XHRcdDxsaT5TdW5kYXk6ICR7c3RvcmVzV2l0aFByb2R1Y3RbaV0uaG91cnMuc3VuZGF5Lm9wZW59IC0gJHtzdG9yZXNXaXRoUHJvZHVjdFtpXS5ob3Vycy5zdW5kYXkuY2xvc2V9PC9saT5cblx0XHRcdDwvdWw+XG5cdFx0XHQ8aDM+Qm90dGxlcyBpbiBzdG9jazogJHtzdG9yZXNXaXRoUHJvZHVjdFtpXS5xdWFudGl0eX08L2gzPlxuXHRcdGA7XG5cdFx0bWFya2Vyc1tpXSA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIoXG5cdFx0XHR7XG5cdFx0XHRcdHBvc2l0aW9uOiBzdG9yZXNXaXRoUHJvZHVjdFtpXS5jb29yZHMsIFxuXHRcdFx0XHRsYWJlbDogYCR7aSsxfWAsXG5cdFx0XHRcdG1hcDogbWFwXG5cdFx0XHR9XG5cdFx0KTtcbiAgICAgICAgaW5mb1dpbmRvd1tpXSA9IG5ldyBnb29nbGUubWFwcy5JbmZvV2luZG93KHtcbiAgICAgICAgXHRjb250ZW50OiBjb250ZW50W2ldXG4gICAgICAgIH0pO1xuICAgICAgICBtYXJrZXJzW2ldLmFkZExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuICAgICAgICBcdGluZm9XaW5kb3dbaV0ub3BlbihtYXAsIG1hcmtlcnNbaV0pO1xuICAgICAgICB9KTtcblx0fVxufVxuXG53aW5lQXBwLmluaXQgPSAoKSA9PiB7XG5cdCQoJyN3aW5lQnV0dG9uJykub24oJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHQkKCcjbG9hZGVyJykuYWRkQ2xhc3MoXCJsb2FkZXJcIik7XG5cdFx0JCgnI2xvY2F0aW9ucycpLnRvZ2dsZShmYWxzZSk7XG5cdFx0JCgnI3dpbmUnKS5lbXB0eSgpO1xuXHRcdHNlYXJjaEZvb2QgPSAkKCcjZm9vZCcpLnZhbCgpO1xuXHRcdHNlYXJjaFByaWNlID0gJCgnI3ByaWNlJykudmFsKCk7XG5cdFx0Y29uc29sZS5sb2coc2VhcmNoRm9vZCArIHNlYXJjaFByaWNlKTtcblx0XHR3aW5lQXBwLmdldFdpbmVzKHNlYXJjaEZvb2QsIHNlYXJjaFByaWNlLCBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqMTAwKSk7XG5cdH0pO1x0XG5cdCQoJyNzdG9yZUJ1dHRvbicpLm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcblx0XHR3aW5lQXBwLmdldFVzZXJDb29yZHMoKTtcblx0XHRjb25zb2xlLmxvZyh3aW5lQXBwLmdldFRpbWUoNTcwKSk7XG5cdH0pO1xufVxuXG4kKGZ1bmN0aW9uKCkge1xuXHR3aW5lQXBwLmluaXQoKTtcbn0pO1xuXG5cbi8vIDEuIGhvdyB0byBsb29wIHRocm91Z2ggZnVuY3Rpb24gb24gaG93IG1hbnkgcGFnZXMgZXhpc3Rcbi8vIDIuIGhvdyB0byBydW4gZmxhdHRlbkFycmF5IGFmdGVyIGdldEFsbFdpbmVzIChwcm9taXNlcz8pXG4iXX0=
